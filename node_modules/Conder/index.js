var  Resource = require('deployd/lib/resource')
	,util = require('util')
	,internalClient = require('deployd/lib/internal-client');

var dpd;
function Conder(name, options) {
    Resource.apply(this, arguments);
}
util.inherits(Conder, Resource);
module.exports = Conder;

Conder.prototype.clientGeneration = true;


Conder.prototype.handle = function (ctx, next) {
	try{
	    if(ctx.req && ctx.req.method == 'GET'){
	    	var square 	= ctx.query.square
	    	var height 	= ctx.query.height
	    	var insol 	= ctx.query.insol
	    	var pcCol 	= ctx.query.pcCol
	    	var people 	= ctx.query.people
			
			console.log(ctx.query);

				ctx.done(null, calcCondPower(square, height, insol, pcCol, people));
	    } else return next();
	} catch(e){
		console.log(e);
	}
}



function calcCondPower(S, H, G, T, P){
	var res = Math.ceil( ((G/1000)*S*H+T*0.3+P*0.1)*10)/10;
  return res.toString();
}


process.server.on('listening', function() {
  dpd = internalClient.build(process.server);
});
