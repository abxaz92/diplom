var  Resource = require('deployd/lib/resource')
	,util = require('util')
	,internalClient = require('deployd/lib/internal-client');

var dpd;
function Floor_wood(name, options) {
    Resource.apply(this, arguments);
}
util.inherits(Floor_wood, Resource);
module.exports = Floor_wood;

Floor_wood.prototype.clientGeneration = true;


Floor_wood.prototype.handle = function (ctx, next) {
	try{
	    if(ctx.req && ctx.req.method == 'GET'){
			ctx.done(null, raschet(ctx.query.ploshady, ctx.query.tolshina, ctx.query.visota));
	    } else return next();
	} catch(e){
		console.log(e);
	}
}

function raschet(ploshady, tolshina, visota){
	if(tolshina <= 200){
		var summa = ploshady / 1.95;
		var balka_sum = ploshady * 3.3;
	}
	else{			
		var summa = ploshady / 1.65;
		var balka_sum = ploshady * 3.5;
	}
		var fixsumma = summa.toFixed();
		var trenogi_sum = (fixsumma / 3)+3;
		var fixtrenogi_sum = trenogi_sum.toFixed();
		var fixbalka_sum = balka_sum.toFixed();
		return {
			 stoyki	: fixsumma
			,univilki: fixsumma
			,trenogi : fixtrenogi_sum
			,balki	: fixbalka_sum
		}
}

process.server.on('listening', function() {
  dpd = internalClient.build(process.server);
});



/*

Стойки		шт
Унивилки	 шт
Треноги	 шт
Балка	м.п.



*/